(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[930],{63:(e,s,t)=>{"use strict";var a=t(7260);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},601:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var a=t(5155),r=t(2115),l=t(9829),i=t(7586),n=t(5229),c=t(4985);let d=(0,l.io)("http://localhost:3001",{transports:["websocket"]});function o(e){let{room:s,onClose:t}=e,{user:l}=(0,c.J)(),[o,m]=(0,r.useState)([]),[h,x]=(0,r.useState)(""),u=(0,r.useRef)(null);return(0,r.useEffect)(()=>{var e;null==(e=u.current)||e.scrollIntoView({behavior:"smooth"})},[o]),(0,r.useEffect)(()=>{if(null==s?void 0:s.roomId)return console.log("\uD83D\uDCCC Joining room: ".concat(s.roomId)),d.emit("joinRoom",s.roomId),fetch("".concat("http://localhost:3001","/messages/").concat(s.roomId)).then(e=>e.json()).then(e=>{m(e.messages.map(e=>({...e,isOwn:e.senderId===l.id}))||[])}).catch(e=>console.error("❌ Fetch messages error:",e)),d.on("newMessage",e=>{m(s=>[...s,{...e,isOwn:e.sender==l.id}])}),()=>{d.off("newMessage")}},[s.roomId]),(0,a.jsx)("div",{className:"fixed inset-0 bg-black/35 flex items-center justify-end z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-sm h-full max-h-[80vh] flex flex-col",children:[(0,a.jsxs)("div",{className:"p-4 border-b bg-indigo-500 text-white rounded-t-xl flex justify-between items-center",children:[(0,a.jsxs)("h3",{className:"font-bold flex items-center",children:[(0,a.jsx)(i.A,{className:"w-5 h-5 mr-2"}),s.roomTitle||"Ph\xf2ng chat"]}),(0,a.jsx)("button",{onClick:t,className:"hover:text-gray-200",children:(0,a.jsx)(n.A,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"flex-grow p-4 space-y-3 overflow-y-auto",children:[o.map(e=>(0,a.jsx)("div",{className:"flex ".concat(e.isOwn?"justify-end":"justify-start"),children:(0,a.jsx)("div",{className:"max-w-xs px-4 py-2 rounded-xl text-sm ".concat(e.isOwn?"bg-indigo-600 text-white rounded-br-none":"bg-gray-200 text-gray-800 rounded-tl-none"),children:e.text})},e.messageId||e.createdAt)),(0,a.jsx)("div",{ref:u})]}),(0,a.jsx)("form",{onSubmit:e=>{if(e.preventDefault(),!h.trim())return;let t={roomId:s.roomId,sender:s.studentId,receiver:s.landlordId,text:h.trim()};d.emit("sendMessage",t),x("")},className:"p-4 border-t",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("input",{type:"text",value:h,onChange:e=>x(e.target.value),placeholder:"Nhập tin nhắn...",className:"flex-grow px-4 py-2 border border-gray-300 rounded-full focus:ring-indigo-500 focus:border-indigo-500"}),(0,a.jsx)("button",{type:"submit",className:"bg-indigo-600 text-white p-3 rounded-full hover:bg-indigo-700 transition",children:"➤"})]})})]})})}},1873:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},3457:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]])},4003:(e,s,t)=>{"use strict";t.d(s,{U9:()=>a,iK:()=>r});let a=[{key:"wifi",label:"Wifi"},{key:"wc",label:"WC ri\xeang"},{key:"airCon",label:"M\xe1y lạnh"},{key:"parking",label:"Chỗ để xe"},{key:"kitchen",label:"Bếp"}],r={STUDENT:"STUDENT",LANDLORD:"LANDLORD"}},4696:(e,s,t)=>{Promise.resolve().then(t.bind(t,7835))},4985:(e,s,t)=>{"use strict";t.d(s,{J:()=>c,UserProvider:()=>n});var a=t(5155),r=t(2115),l=t(8032);let i=(0,r.createContext)(void 0),n=e=>{let{children:s}=e,[t,n]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(null==t?void 0:t.id)&&(l.s.emit("register",t.id),console.log("\uD83D\uDCE1 Registered user:",t.id))},[t]),(0,a.jsx)(i.Provider,{value:{user:t,setUser:n},children:s})},c=()=>{let e=(0,r.useContext)(i);if(!e)throw Error("useUser must be used within UserProvider");return e}},5229:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5626:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6154:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},7217:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]])},7586:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(1847).A)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},7835:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var a=t(5155),r=t(2115),l=t(63),i=t(5626),n=t(1873),c=t(7217),d=t(6154);let o=(0,t(1847).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);var m=t(7586),h=t(3457),x=t(2619),u=t.n(x),g=t(4003),f=t(601);function p(){var e;let s=(0,l.useParams)(),[t,x]=(0,r.useState)(null),[p,j]=(0,r.useState)(!0),[y]=(0,r.useState)({id:"U1",role:g.iK.STUDENT}),[b,N]=(0,r.useState)(null);if((0,r.useEffect)(()=>{!async function(){try{let e=await fetch("/api/proxy/rooms/".concat(s.id)),t=await e.json();x(t)}catch(e){console.error("Error fetching room:",e),x(null)}finally{j(!1)}}()},[s.id]),p)return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Đang tải th\xf4ng tin ph\xf2ng trọ..."})]})});if(!t)return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Kh\xf4ng t\xecm thấy ph\xf2ng trọ"}),(0,a.jsx)(u(),{href:"/",className:"text-indigo-600 hover:text-indigo-800",children:"← Quay lại trang chủ"})]})});let v=g.U9.filter(e=>t.amenities.includes(e.key)).map(e=>e.label);return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)(u(),{href:"/",className:"inline-flex items-center text-indigo-600 hover:text-indigo-800 transition",children:[(0,a.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"Quay lại danh s\xe1ch"]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("img",{src:t.imageUrl||(null==(e=t.images)?void 0:e[0]),alt:t.title||t.address,className:"w-full h-96 object-cover rounded-xl shadow-lg",onError:e=>{e.target.onerror=null,e.target.src="https://placehold.co/800x400/CCCCCC/333333?text=No+Image"}})}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-4",children:t.title||t.address}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,a.jsx)(n.A,{className:"w-5 h-5 mr-3 text-indigo-500"}),(0,a.jsx)("span",{children:t.location||t.address})]}),(0,a.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,a.jsx)(c.A,{className:"w-5 h-5 mr-3 text-indigo-500"}),(0,a.jsxs)("span",{children:[t.area," m\xb2"]})]})]}),t.description&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:"M\xf4 tả"}),(0,a.jsx)("p",{className:"text-gray-600 leading-relaxed",children:t.description})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:"Tiện \xedch"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:v.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center text-gray-600",children:[(0,a.jsx)(d.A,{className:"w-4 h-4 mr-2 text-green-500"}),(0,a.jsx)("span",{children:e})]},s))})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:"Đ\xe1nh gi\xe1"}),(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"flex items-center",children:[1,2,3,4,5].map(e=>(0,a.jsx)(o,{className:"w-5 h-5 text-yellow-400 fill-current"},e))}),(0,a.jsx)("span",{className:"ml-2 text-gray-600",children:"4.5/5 (12 đ\xe1nh gi\xe1)"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Chưa c\xf3 đ\xe1nh gi\xe1 n\xe0o. H\xe3y l\xe0 người đầu ti\xean đ\xe1nh gi\xe1!"})]})]})]}),(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 sticky top-8",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsxs)("div",{className:"text-4xl font-bold text-indigo-600 mb-2",children:[new Intl.NumberFormat("vi-VN").format(t.price)," VNĐ"]}),(0,a.jsx)("div",{className:"text-gray-500",children:"/th\xe1ng"})]}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-800 mb-2",children:"Chủ trọ"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["ID: ",t.landlordId]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Đ\xe3 tham gia: 2 năm"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("button",{onClick:()=>N(t),className:"w-full flex items-center justify-center px-4 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition font-medium",children:[(0,a.jsx)(m.A,{className:"w-5 h-5 mr-2"}),"Li\xean hệ chủ trọ"]}),(0,a.jsxs)("button",{className:"w-full flex items-center justify-center px-4 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition font-medium",children:[(0,a.jsx)(h.A,{className:"w-5 h-5 mr-2"}),"Lưu ph\xf2ng n\xe0y"]})]}),(0,a.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-800 mb-3",children:"Th\xf4ng tin bổ sung"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,a.jsx)("p",{children:"• Ph\xf2ng đ\xe3 được x\xe1c minh"}),(0,a.jsx)("p",{children:"• C\xf3 thể xem ph\xf2ng ngay"}),(0,a.jsx)("p",{children:"• Hỗ trợ 24/7"})]})]})]})})]})]}),b&&(0,a.jsx)(f.A,{room:b,onClose:()=>N(null)})]})}},8032:(e,s,t)=>{"use strict";t.d(s,{s:()=>a});let a=(0,t(9829).io)("http://localhost:3001",{transports:["websocket"],autoConnect:!0})}},e=>{e.O(0,[297,829,441,255,358],()=>e(e.s=4696)),_N_E=e.O()}]);